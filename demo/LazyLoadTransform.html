<!doctype html>
<html lang=en>

  <head>
    <meta charset=utf-8>
    <title>LazyLoadTransform</title>
    <link href=../build/wikimedia-page-library-transform.css rel=stylesheet>
    <style>
      body { margin: 4px 4px; }
      .pagelib-lazy-load-placeholder { margin: 4px 4px; float: left; }
    </style>
  </head>

  <body>
    <script src=../build/wikimedia-page-library-transform.js></script>
    <script src=./LazyLoadImageData.js></script>
    <script>
      /* global pagelib, LazyLoadImageData */
      const lazyDocument = document.implementation.createHTMLDocument()

      const div = lazyDocument.createElement('div')
      for (const data of LazyLoadImageData) {
        const img = lazyDocument.createElement('img')
        img.setAttribute('src', `https:${data.src}`)
        img.setAttribute('width', data.width)
        img.setAttribute('height', data.height)
        div.appendChild(img)
      }

      const images = pagelib.LazyLoadTransform.queryTransformImages(div)
      pagelib.LazyLoadTransform.transform(document, images)

      div.querySelectorAll('.pagelib-lazy-load-placeholder').forEach(placeholder => {
        placeholder.addEventListener('click', () => {
          pagelib.LazyLoadTransform.loadImage(document, placeholder)
        }, { once: true })
      })
      document.querySelector('body').appendChild(div)</script>
  </body>

</html>